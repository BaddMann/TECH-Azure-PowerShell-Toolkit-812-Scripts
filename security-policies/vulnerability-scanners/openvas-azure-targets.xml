<?xml version="1.0" encoding="UTF-8"?>
<openvas_targets>
  <config_version>11.0</config_version>
  <created>2025-06-16T10:00:00Z</created>
  <description>OpenVAS target configuration for Azure enterprise security scanning</description>
  <owner>security-team@company.com</owner>
  
  <!-- Azure Production Environment Targets -->
  <target id="azure-prod-001">
    <name>Azure Production Virtual Machines</name>
    <comment>Production VMs in Azure East US and West Europe regions</comment>
    <creation_time>2025-06-16T10:00:00Z</creation_time>
    <modification_time>2025-06-16T10:00:00Z</modification_time>
    <owner>
      <name>Azure Security Team</name>
    </owner>
    <hosts>
      <!-- Production VM IP ranges -->
      <host>10.0.1.0/24</host>
      <host>10.0.2.0/24</host>
      <host>10.0.3.0/24</host>
      <!-- Specific high-value targets -->
      <host>10.0.1.10</host> <!-- Domain Controller -->
      <host>10.0.1.11</host> <!-- SQL Server -->
      <host>10.0.1.12</host> <!-- Web Server -->
      <host>10.0.2.10</host> <!-- File Server -->
      <host>10.0.2.11</host> <!-- Application Server -->
    </hosts>
    <exclude_hosts>
      <!-- Exclude sensitive systems during business hours -->
      <host>10.0.1.100</host> <!-- Production payment processor -->
      <host>10.0.1.101</host> <!-- Live trading system -->
    </exclude_hosts>
    <port_list id="iana-tcp-udp">
      <name>IANA TCP/UDP All Ports</name>
      <port_range>T:1-65535,U:1-1024</port_range>
    </port_list>
    <port_list id="top-ports">
      <name>Top 1000 TCP/UDP Ports</name>
      <port_range>T:1-1024,U:53,67,68,69,123,135,137,138,139,161,389,443,445,993,995</port_range>
    </port_list>
    <alive_test>Consider Alive</alive_test>
    <credentials>
      <ssh>
        <username>azure-scanner</username>
        <key>
          <private>-----BEGIN OPENSSH PRIVATE KEY-----
{SSH_PRIVATE_KEY_CONTENT}
-----END OPENSSH PRIVATE KEY-----</private>
          <public>ssh-rsa {SSH_PUBLIC_KEY_CONTENT} azure-scanner@scanner.local</public>
        </key>
        <port>22</port>
      </ssh>
      <smb>
        <username>azure-scanner</username>
        <password>{SMB_PASSWORD}</password>
        <domain>COMPANY</domain>
      </smb>
    </credentials>
    <scanner_preferences>
      <preference>
        <name>checks_read_timeout</name>
        <value>5</value>
      </preference>
      <preference>
        <name>network_scan</name>
        <value>yes</value>
      </preference>
      <preference>
        <name>optimize_test</name>
        <value>yes</value>
      </preference>
    </scanner_preferences>
  </target>

  <!-- Azure Web Applications Target -->
  <target id="azure-webapps-001">
    <name>Azure Web Applications</name>
    <comment>Public-facing Azure web applications and APIs</comment>
    <creation_time>2025-06-16T10:00:00Z</creation_time>
    <modification_time>2025-06-16T10:00:00Z</modification_time>
    <owner>
      <name>Web Security Team</name>
    </owner>
    <hosts>
      <!-- Azure App Service URLs -->
      <host>company-prod.azurewebsites.net</host>
      <host>company-api.azurewebsites.net</host>
      <host>company-admin.azurewebsites.net</host>
      <host>company-mobile-api.azurewebsites.net</host>
      <!-- Custom domain web applications -->
      <host>www.company.com</host>
      <host>api.company.com</host>
      <host>admin.company.com</host>
      <host>portal.company.com</host>
      <!-- Application Gateway public IPs -->
      <host>20.50.100.10</host>
      <host>20.50.100.11</host>
    </hosts>
    <port_list id="web-ports">
      <name>Web Application Ports</name>
      <port_range>T:80,443,8080,8443,8000,8001,8888,9000,9001</port_range>
    </port_list>
    <alive_test>ICMP, TCP-ACK Service &amp; ARP Ping</alive_test>
    <scanner_preferences>
      <preference>
        <name>checks_read_timeout</name>
        <value>10</value>
      </preference>
      <preference>
        <name>network_scan</name>
        <value>no</value>
      </preference>
      <preference>
        <name>optimize_test</name>
        <value>yes</value>
      </preference>
      <!-- Web application specific settings -->
      <preference>
        <name>HTTP User-Agent</name>
        <value>Mozilla/5.0 (compatible; OpenVAS-Scanner)</value>
      </preference>
      <preference>
        <name>Enable web application tests</name>
        <value>yes</value>
      </preference>
      <preference>
        <name>Number of pages to crawl</name>
        <value>50</value>
      </preference>
      <preference>
        <name>Test embedded web servers</name>
        <value>yes</value>
      </preference>
    </scanner_preferences>
  </target>

  <!-- Azure Database Servers Target -->
  <target id="azure-databases-001">
    <name>Azure Database Servers</name>
    <comment>Azure SQL databases and managed database services</comment>
    <creation_time>2025-06-16T10:00:00Z</creation_time>
    <modification_time>2025-06-16T10:00:00Z</modification_time>
    <owner>
      <name>Database Security Team</name>
    </owner>
    <hosts>
      <!-- Azure SQL Database servers -->
      <host>company-prod-sql.database.windows.net</host>
      <host>company-staging-sql.database.windows.net</host>
      <host>company-analytics-sql.database.windows.net</host>
      <!-- Azure Database for MySQL -->
      <host>company-mysql.mysql.database.azure.com</host>
      <!-- Azure Database for PostgreSQL -->
      <host>company-postgres.postgres.database.azure.com</host>
      <!-- Cosmos DB endpoints -->
      <host>company-cosmos.documents.azure.com</host>
      <!-- Redis Cache -->
      <host>company-redis.redis.cache.windows.net</host>
    </hosts>
    <port_list id="database-ports">
      <name>Database Service Ports</name>
      <port_range>T:1433,3306,5432,6379,27017,1521,1024-1030</port_range>
    </port_list>
    <alive_test>TCP-ACK Service Ping</alive_test>
    <credentials>
      <database>
        <type>mssql</type>
        <server>company-prod-sql.database.windows.net</server>
        <username>security_scanner</username>
        <password>{SQL_SCANNER_PASSWORD}</password>
        <instance>default</instance>
      </database>
      <database>
        <type>mysql</type>
        <server>company-mysql.mysql.database.azure.com</server>
        <username>security_scanner</username>
        <password>{MYSQL_SCANNER_PASSWORD}</password>
      </database>
      <database>
        <type>postgresql</type>
        <server>company-postgres.postgres.database.azure.com</server>
        <username>security_scanner</username>
        <password>{POSTGRES_SCANNER_PASSWORD}</password>
      </database>
    </credentials>
    <scanner_preferences>
      <preference>
        <name>timeout_retry</name>
        <value>3</value>
      </preference>
      <preference>
        <name>optimization[timeout_retry]</name>
        <value>3</value>
      </preference>
      <preference>
        <name>Database settings[timeout_retry]</name>
        <value>3</value>
      </preference>
    </scanner_preferences>
  </target>

  <!-- Azure Staging Environment Target -->
  <target id="azure-staging-001">
    <name>Azure Staging Environment</name>
    <comment>Staging environment for pre-production security testing</comment>
    <creation_time>2025-06-16T10:00:00Z</creation_time>
    <modification_time>2025-06-16T10:00:00Z</modification_time>
    <owner>
      <name>QA Security Team</name>
    </owner>
    <hosts>
      <!-- Staging VM ranges -->
      <host>10.1.0.0/24</host>
      <host>10.1.1.0/24</host>
      <!-- Staging web applications -->
      <host>company-staging.azurewebsites.net</host>
      <host>staging-api.company.com</host>
      <!-- Staging databases -->
      <host>company-staging-sql.database.windows.net</host>
    </hosts>
    <port_list id="all-tcp-udp">
      <name>All TCP and UDP ports</name>
      <port_range>T:1-65535,U:1-65535</port_range>
    </port_list>
    <alive_test>ICMP, TCP-ACK Service &amp; ARP Ping</alive_test>
    <credentials>
      <ssh>
        <username>staging-scanner</username>
        <password>{STAGING_SSH_PASSWORD}</password>
        <port>22</port>
      </ssh>
    </credentials>
    <scanner_preferences>
      <preference>
        <name>safe_checks</name>
        <value>no</value>
      </preference>
      <preference>
        <name>checks_read_timeout</name>
        <value>15</value>
      </preference>
      <preference>
        <name>network_scan</name>
        <value>yes</value>
      </preference>
      <preference>
        <name>port_scan</name>
        <value>yes</value>
      </preference>
    </scanner_preferences>
  </target>

  <!-- Azure Network Infrastructure Target -->
  <target id="azure-network-001">
    <name>Azure Network Infrastructure</name>
    <comment>Azure network devices, firewalls, and load balancers</comment>
    <creation_time>2025-06-16T10:00:00Z</creation_time>
    <modification_time>2025-06-16T10:00:00Z</modification_time>
    <owner>
      <name>Network Security Team</name>
    </owner>
    <hosts>
      <!-- Virtual Network Gateways -->
      <host>20.50.200.10</host>
      <host>20.50.200.11</host>
      <!-- Application Gateways -->
      <host>20.50.100.20</host>
      <host>20.50.100.21</host>
      <!-- Load Balancers -->
      <host>20.50.150.30</host>
      <host>20.50.150.31</host>
      <!-- Network Virtual Appliances -->
      <host>10.0.0.10</host>
      <host>10.0.0.11</host>
    </hosts>
    <port_list id="network-services">
      <name>Network Service Ports</name>
      <port_range>T:22,23,53,80,161,162,179,443,500,514,1194,1701,1723,4500</port_range>
    </port_list>
    <alive_test>ICMP, TCP-ACK Service &amp; ARP Ping</alive_test>
    <credentials>
      <snmp>
        <username>network-scanner</username>
        <password>{SNMP_PASSWORD}</password>
        <community>public</community>
        <auth_algorithm>SHA1</auth_algorithm>
        <privacy_algorithm>AES</privacy_algorithm>
      </snmp>
    </credentials>
    <scanner_preferences>
      <preference>
        <name>timeout_retry</name>
        <value>2</value>
      </preference>
      <preference>
        <name>expand_vhosts</name>
        <value>yes</value>
      </preference>
    </scanner_preferences>
  </target>

  <!-- Azure Development Environment Target -->
  <target id="azure-dev-001">
    <name>Azure Development Environment</name>
    <comment>Development environment for comprehensive security testing</comment>
    <creation_time>2025-06-16T10:00:00Z</creation_time>
    <modification_time>2025-06-16T10:00:00Z</modification_time>
    <owner>
      <name>Development Security Team</name>
    </owner>
    <hosts>
      <!-- Development VM ranges -->
      <host>10.2.0.0/16</host>
      <!-- Development web applications -->
      <host>company-dev.azurewebsites.net</host>
      <host>dev-api.company.com</host>
      <!-- Development databases -->
      <host>company-dev-sql.database.windows.net</host>
      <!-- Container registries -->
      <host>companydev.azurecr.io</host>
    </hosts>
    <port_list id="full-scan-ports">
      <name>Full Port Range Scan</name>
      <port_range>T:1-65535,U:1-1024</port_range>
    </port_list>
    <alive_test>Consider Alive</alive_test>
    <credentials>
      <ssh>
        <username>dev-scanner</username>
        <key>
          <private>-----BEGIN OPENSSH PRIVATE KEY-----
{DEV_SSH_PRIVATE_KEY}
-----END OPENSSH PRIVATE KEY-----</private>
        </key>
        <port>22</port>
      </ssh>
      <smb>
        <username>dev-scanner</username>
        <password>{DEV_SMB_PASSWORD}</password>
        <domain>DEVDOMAIN</domain>
      </smb>
    </credentials>
    <scanner_preferences>
      <preference>
        <name>safe_checks</name>
        <value>no</value>
      </preference>
      <preference>
        <name>checks_read_timeout</name>
        <value>20</value>
      </preference>
      <preference>
        <name>network_scan</name>
        <value>yes</value>
      </preference>
      <preference>
        <name>port_scan</name>
        <value>yes</value>
      </preference>
      <preference>
        <name>optimize_test</name>
        <value>no</value>
      </preference>
    </scanner_preferences>
  </target>

  <!-- Azure External Services Target -->
  <target id="azure-external-001">
    <name>Azure External-Facing Services</name>
    <comment>Externally accessible Azure services and endpoints</comment>
    <creation_time>2025-06-16T10:00:00Z</creation_time>
    <modification_time>2025-06-16T10:00:00Z</modification_time>
    <owner>
      <name>External Security Team</name>
    </owner>
    <hosts>
      <!-- Public endpoints -->
      <host>company.com</host>
      <host>www.company.com</host>
      <host>api.company.com</host>
      <host>blog.company.com</host>
      <host>docs.company.com</host>
      <!-- CDN endpoints -->
      <host>cdn.company.com</host>
      <host>static.company.com</host>
      <!-- Mail servers -->
      <host>mail.company.com</host>
      <host>webmail.company.com</host>
      <!-- External APIs -->
      <host>publicapi.company.com</host>
      <host>webhook.company.com</host>
    </hosts>
    <port_list id="external-ports">
      <name>External Service Ports</name>
      <port_range>T:21,22,25,53,80,110,143,443,465,587,993,995,2222,8080,8443</port_range>
    </port_list>
    <alive_test>TCP-ACK Service Ping</alive_test>
    <scanner_preferences>
      <preference>
        <name>checks_read_timeout</name>
        <value>10</value>
      </preference>
      <preference>
        <name>network_scan</name>
        <value>no</value>
      </preference>
      <preference>
        <name>port_scan</name>
        <value>yes</value>
      </preference>
      <preference>
        <name>safe_checks</name>
        <value>yes</value>
      </preference>
      <!-- External scanning considerations -->
      <preference>
        <name>HTTP User-Agent</name>
        <value>Mozilla/5.0 (compatible; CompanySecurityScanner)</value>
      </preference>
      <preference>
        <name>Enable web application tests</name>
        <value>yes</value>
      </preference>
      <preference>
        <name>Test SSL/TLS services</name>
        <value>yes</value>
      </preference>
    </scanner_preferences>
  </target>

  <!-- Scan Configurations -->
  <scan_configs>
    <config id="azure-comprehensive">
      <name>Azure Comprehensive Security Scan</name>
      <comment>Comprehensive security scan for Azure environments</comment>
      <type>0</type>
      <family_count>
        <growing>1</growing>
      </family_count>
      <family_selection>
        <family>
          <name>Buffer overflow</name>
          <nvt_count>15</nvt_count>
          <max_nvt_count>15</max_nvt_count>
        </family>
        <family>
          <name>Compliance</name>
          <nvt_count>50</nvt_count>
          <max_nvt_count>50</max_nvt_count>
        </family>
        <family>
          <name>Credentials</name>
          <nvt_count>25</nvt_count>
          <max_nvt_count>25</max_nvt_count>
        </family>
        <family>
          <name>Databases</name>
          <nvt_count>200</nvt_count>
          <max_nvt_count>200</max_nvt_count>
        </family>
        <family>
          <name>Default Accounts</name>
          <nvt_count>30</nvt_count>
          <max_nvt_count>30</max_nvt_count>
        </family>
        <family>
          <name>Denial of Service</name>
          <nvt_count>0</nvt_count>
          <max_nvt_count>100</max_nvt_count>
        </family>
        <family>
          <name>General</name>
          <nvt_count>500</nvt_count>
          <max_nvt_count>500</max_nvt_count>
        </family>
        <family>
          <name>Malware</name>
          <nvt_count>75</nvt_count>
          <max_nvt_count>75</max_nvt_count>
        </family>
        <family>
          <name>Product detection</name>
          <nvt_count>800</nvt_count>
          <max_nvt_count>800</max_nvt_count>
        </family>
        <family>
          <name>Web application abuses</name>
          <nvt_count>1500</nvt_count>
          <max_nvt_count>1500</max_nvt_count>
        </family>
      </family_selection>
      <nvt_selection>
        <family>Compliance</family>
        <family>Credentials</family>
        <family>Databases</family>
        <family>Default Accounts</family>
        <family>General</family>
        <family>Malware</family>
        <family>Product detection</family>
        <family>Web application abuses</family>
      </nvt_selection>
      <scanner_name>OpenVAS Scanner</scanner_name>
      <preferences>
        <preference>
          <name>checks_read_timeout</name>
          <value>5</value>
        </preference>
        <preference>
          <name>network_scan</name>
          <value>yes</value>
        </preference>
        <preference>
          <name>optimize_test</name>
          <value>yes</value>
        </preference>
        <preference>
          <name>port_scan</name>
          <value>yes</value>
        </preference>
        <preference>
          <name>safe_checks</name>
          <value>yes</value>
        </preference>
        <preference>
          <name>timeout_retry</name>
          <value>3</value>
        </preference>
      </preferences>
    </config>

    <config id="azure-web-app">
      <name>Azure Web Application Security Scan</name>
      <comment>Focused web application security testing for Azure web apps</comment>
      <type>0</type>
      <family_selection>
        <family>
          <name>Web application abuses</name>
          <nvt_count>1500</nvt_count>
          <max_nvt_count>1500</max_nvt_count>
        </family>
        <family>
          <name>Product detection</name>
          <nvt_count>300</nvt_count>
          <max_nvt_count>800</max_nvt_count>
        </family>
        <family>
          <name>General</name>
          <nvt_count>100</nvt_count>
          <max_nvt_count>500</max_nvt_count>
        </family>
      </family_selection>
      <preferences>
        <preference>
          <name>Enable web application tests</name>
          <value>yes</value>
        </preference>
        <preference>
          <name>Number of pages to crawl</name>
          <value>100</value>
        </preference>
        <preference>
          <name>Test embedded web servers</name>
          <value>yes</value>
        </preference>
        <preference>
          <name>Web application[Test XSS]</name>
          <value>yes</value>
        </preference>
        <preference>
          <name>Web application[Test SQL injection]</name>
          <value>yes</value>
        </preference>
      </preferences>
    </config>
  </scan_configs>

  <!-- Report Formats -->
  <report_formats>
    <format id="azure-security-report">
      <name>Azure Security Assessment Report</name>
      <extension>html</extension>
      <content_type>text/html</content_type>
      <summary>Comprehensive security assessment report for Azure environments</summary>
      <description>Detailed HTML report including executive summary, technical findings, compliance status, and remediation recommendations specific to Azure environments.</description>
    </format>

    <format id="azure-compliance-report">
      <name>Azure Compliance Report</name>
      <extension>pdf</extension>
      <content_type>application/pdf</content_type>
      <summary>Compliance-focused report for Azure security standards</summary>
      <description>PDF report focused on compliance with CIS Azure Benchmark, NIST Cybersecurity Framework, and other regulatory requirements.</description>
    </format>
  </report_formats>

  <!-- Filters -->
  <filters>
    <filter id="azure-critical-high">
      <name>Azure Critical and High Severity</name>
      <term>severity~critical,high and not type~log_message</term>
      <type>result</type>
      <comment>Filter for critical and high severity findings in Azure scans</comment>
    </filter>

    <filter id="azure-compliance-failures">
      <name>Azure Compliance Failures</name>
      <term>severity~medium,high,critical and compliance~"CIS Azure" and not result~"Compliant"</term>
      <type>result</type>
      <comment>Filter for compliance failures against Azure security standards</comment>
    </filter>

    <filter id="azure-web-vulnerabilities">
      <name>Azure Web Application Vulnerabilities</name>
      <term>family~"Web application abuses" and severity~medium,high,critical</term>
      <type>result</type>
      <comment>Filter for web application vulnerabilities in Azure web apps</comment>
    </filter>
  </filters>

  <!-- Alerts -->
  <alerts>
    <alert id="azure-critical-alert">
      <name>Azure Critical Vulnerability Alert</name>
      <comment>Immediate notification for critical vulnerabilities in Azure</comment>
      <condition>Task run status changed</condition>
      <filter id="azure-critical-high"/>
      <method>
        <type>email</type>
        <data>
          <name>to_address</name>
          <value>security-team@company.com,ciso@company.com</value>
        </data>
        <data>
          <name>from_address</name>
          <value>openvas-scanner@company.com</value>
        </data>
        <data>
          <name>subject</name>
          <value>CRITICAL: Azure Security Vulnerabilities Detected</value>
        </data>
      </method>
    </alert>

    <alert id="azure-compliance-alert">
      <name>Azure Compliance Failure Alert</name>
      <comment>Notification for compliance failures in Azure environment</comment>
      <condition>Task run status changed</condition>
      <filter id="azure-compliance-failures"/>
      <method>
        <type>email</type>
        <data>
          <name>to_address</name>
          <value>compliance-team@company.com,security-team@company.com</value>
        </data>
        <data>
          <name>from_address</name>
          <value>openvas-scanner@company.com</value>
        </data>
        <data>
          <name>subject</name>
          <value>Azure Compliance Failures Detected</value>
        </data>
      </method>
    </alert>
  </alerts>

  <!-- Schedules -->
  <schedules>
    <schedule id="azure-weekly-scan">
      <name>Azure Weekly Security Scan</name>
      <comment>Weekly comprehensive security scan of Azure production environment</comment>
      <timezone>UTC</timezone>
      <icalendar>
        DTSTART:20250616T020000Z
        RRULE:FREQ=WEEKLY;BYDAY=SU
      </icalendar>
    </schedule>

    <schedule id="azure-daily-external">
      <name>Azure Daily External Scan</name>
      <comment>Daily scan of external-facing Azure services</comment>
      <timezone>UTC</timezone>
      <icalendar>
        DTSTART:20250616T060000Z
        RRULE:FREQ=DAILY
      </icalendar>
    </schedule>
  </schedules>

</openvas_targets>